[gd_scene load_steps=17 format=3 uid="uid://cw0bk0h1o70ne"]

[ext_resource type="Texture2D" uid="uid://cxuejfat7wko5" path="res://assets/textures/GroundPrototype/dark/texture_08.png" id="1_qqf0u"]
[ext_resource type="PackedScene" uid="uid://bbquwaao37aja" path="res://assets/prefabs/characters/actor_ped.tscn" id="2_1nv3g"]
[ext_resource type="Script" uid="uid://csbl3jypfxtwg" path="res://addons/FlowAI/scripts/runtime/FlowAIAreaNode.gd" id="2_alfe8"]
[ext_resource type="Script" uid="uid://bysxpb73lr46b" path="res://addons/FlowAI/scripts/core/FlowAIController.gd" id="2_cv82n"]
[ext_resource type="Script" uid="uid://i1dbg8h2x6sq" path="res://addons/FlowAI/scripts/runtime/FlowAIPathNode.gd" id="3_1dh4r"]
[ext_resource type="PackedScene" uid="uid://j5nwodo50yh3" path="res://assets/prefabs/characters/actor_player.tscn" id="4_cv82n"]
[ext_resource type="Script" uid="uid://mk0cs7tsd178" path="res://scripts/core/systems/PedSpawner/PedSpawnerController.gd" id="5_8egd3"]
[ext_resource type="Texture2D" uid="uid://4pxnh1mqg4f6" path="res://assets/textures/hdri/qwantani_noon_puresky_2k.exr" id="7_72xuw"]
[ext_resource type="Script" uid="uid://c8oqvjek0jr6i" path="res://scripts/core/systems/PedSpawner/PedSpawnerSlot.gd" id="7_alfe8"]

[sub_resource type="NavigationMesh" id="NavigationMesh_cv82n"]
vertices = PackedVector3Array(-19.5, 0.5, -19.5, -19.5, 0.5, 19.5, 19.5, 0.5, 19.5, 19.5, 0.5, -19.5)
polygons = [PackedInt32Array(3, 2, 0), PackedInt32Array(0, 2, 1)]

[sub_resource type="PlaneMesh" id="PlaneMesh_cv82n"]
size = Vector2(40, 40)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_xw8bb"]
albedo_texture = ExtResource("1_qqf0u")
uv1_scale = Vector3(0.1, 0.1, 0.1)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_72xuw"]
data = PackedVector3Array(20, 0, 20, -20, 0, 20, 20, 0, -20, -20, 0, 20, -20, 0, -20, 20, 0, -20)

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_8egd3"]
panorama = ExtResource("7_72xuw")

[sub_resource type="Sky" id="Sky_alfe8"]
sky_material = SubResource("PanoramaSkyMaterial_8egd3")

[sub_resource type="Environment" id="Environment_1dh4r"]
background_mode = 2
sky = SubResource("Sky_alfe8")

[node name="CrowdAIScene" type="Node3D"]

[node name="map" type="Node" parent="."]

[node name="FlowAIController" type="Node" parent="map" node_paths=PackedStringArray("all_areas", "all_pathnodes")]
script = ExtResource("2_cv82n")
DataPath = "res://data/CrowdAIScenePathnodesData.json"
all_areas = [NodePath("area_1")]
all_pathnodes = [NodePath("area_1/pathnode_1"), NodePath("area_1/pathnode_2"), NodePath("area_1/pathnode_3"), NodePath("area_1/pathnode_4"), NodePath("area_1/pathnode_5"), NodePath("area_1/pathnode_6"), NodePath("area_1/pathnode_7"), NodePath("area_1/pathnode_8"), NodePath("area_1/pathnode_9")]
metadata/_custom_type_script = "uid://bysxpb73lr46b"

[node name="area_1" type="Node3D" parent="map/FlowAIController" node_paths=PackedStringArray("flowAI_controller")]
script = ExtResource("2_alfe8")
ID = 1
area_pathnodes = Array[int]([1, 2, 3, 4, 5, 6, 7, 8, 9])
flowAI_controller = NodePath("..")

[node name="pathnode_1" type="Marker3D" parent="map/FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
script = ExtResource("3_1dh4r")
ID = 1
areaID = 1
links = Array[int]([2, 3])
flowAI_controller = NodePath("../..")

[node name="pathnode_2" type="Marker3D" parent="map/FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 5)
script = ExtResource("3_1dh4r")
ID = 2
areaID = 1
prev_pathnode = 1
links = Array[int]([7, 6])
flowAI_controller = NodePath("../..")

[node name="pathnode_3" type="Marker3D" parent="map/FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -5)
script = ExtResource("3_1dh4r")
ID = 3
areaID = 1
prev_pathnode = 1
links = Array[int]([4, 9])
flowAI_controller = NodePath("../..")

[node name="pathnode_4" type="Marker3D" parent="map/FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 0, -5)
script = ExtResource("3_1dh4r")
ID = 4
areaID = 1
prev_pathnode = 3
links = Array[int]([5])
flowAI_controller = NodePath("../..")

[node name="pathnode_5" type="Marker3D" parent="map/FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 0, 0)
script = ExtResource("3_1dh4r")
ID = 5
areaID = 1
prev_pathnode = 4
links = Array[int]([6])
flowAI_controller = NodePath("../..")

[node name="pathnode_6" type="Marker3D" parent="map/FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 0, 5)
script = ExtResource("3_1dh4r")
ID = 6
areaID = 1
prev_pathnode = 5
flowAI_controller = NodePath("../..")

[node name="pathnode_7" type="Marker3D" parent="map/FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, 5)
script = ExtResource("3_1dh4r")
ID = 7
areaID = 1
prev_pathnode = 2
links = Array[int]([8])
flowAI_controller = NodePath("../..")

[node name="pathnode_8" type="Marker3D" parent="map/FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, 0)
script = ExtResource("3_1dh4r")
ID = 8
areaID = 1
prev_pathnode = 7
links = Array[int]([9])
flowAI_controller = NodePath("../..")

[node name="pathnode_9" type="Marker3D" parent="map/FlowAIController/area_1" node_paths=PackedStringArray("flowAI_controller")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, -5)
script = ExtResource("3_1dh4r")
ID = 9
areaID = 1
prev_pathnode = 8
flowAI_controller = NodePath("../..")

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="map"]
navigation_mesh = SubResource("NavigationMesh_cv82n")

[node name="plane" type="MeshInstance3D" parent="map/NavigationRegion3D"]
mesh = SubResource("PlaneMesh_cv82n")
surface_material_override/0 = SubResource("StandardMaterial3D_xw8bb")

[node name="StaticBody3D" type="StaticBody3D" parent="map/NavigationRegion3D/plane"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="map/NavigationRegion3D/plane/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_72xuw")

[node name="PedSpawnerController" type="Node" parent="map" node_paths=PackedStringArray("SpawnerSlotsPath", "SpawnerNpcPath", "FlowAIControllerNode", "PlayerRef")]
script = ExtResource("5_8egd3")
SpawnerSlotsPath = NodePath("Spawners")
SpawnerNpcPath = NodePath("../../actor")
FlowAIControllerNode = NodePath("../FlowAIController")
PlayerRef = NodePath("../../actor/actor_player")
NpcScene = ExtResource("2_1nv3g")
spawn_radius = 3.0
despawn_radius = 5.0
metadata/_custom_type_script = "uid://mk0cs7tsd178"

[node name="Spawners" type="Node" parent="map/PedSpawnerController"]

[node name="PedSpawnerSlot" type="Marker3D" parent="map/PedSpawnerController/Spawners"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5, 0, 13)
script = ExtResource("7_alfe8")
ped_spawner_type = 1
peds_size = 2
metadata/_custom_type_script = "uid://c8oqvjek0jr6i"

[node name="actor" type="Node" parent="."]

[node name="actor_ped" parent="actor" instance=ExtResource("2_1nv3g")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)

[node name="actor_player" parent="actor" instance=ExtResource("4_cv82n")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -13)

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_1dh4r")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, 0.75, -0.433013, 0, 0, 0)
shadow_enabled = true
